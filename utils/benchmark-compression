#!/bin/bash

prefix=benchmarks/encode

clang -Wall -Wpedantic -lpng $prefix/baseline/main.c -o $prefix/baseline/main || exit 1
swift build -c release --product encode-benchmark || exit 1 
baseline=$prefix/baseline/main
swift=.build/release/encode-benchmark
for file in $prefix/in/*.png; do 
    name=$(basename $file)
    echo "BASELINE:"
    for ((i=0; i<=9; i++)); do
        $baseline   $prefix/in/$name ${name%.png} $i
    done
    echo "SWIFT:"
    $swift      $prefix/in/$name ${name%.png} 9
    echo ""
done 
